// ENUMS FOR PRODUCT

enum ProductType {
  PHYSICAL          // Eco-Friendly, Sustainable, Handmade, Local products
  HEALTH_WELLNESS  // Sunnah Health, Personal Care
  EVENT_SUPPLY     // Party/Event items
  REPAIR_KIT       // Repair & Restoration Kits
  DECOR            // Islamic Art & Decor
}

enum ProductStatus {
  DRAFT
  ACTIVE
  INACTIVE
  OUT_OF_STOCK
  DISCONTINUED
}

// ============================================
// MAIN PRODUCT TABLE

model Product {
  id          String   @id @default(cuid())
  sku         String   @unique
  name        String
  slug        String   @unique
  description String?  @db.Text
  shortDescription String? @db.Text
  
  productType ProductType
  status      ProductStatus @default(DRAFT)
 
  // Pricing
  basePrice   Decimal  @db.Decimal(10, 2)
  salePrice   Decimal? @db.Decimal(10, 2)
  costPrice   Decimal? @db.Decimal(10, 2)
  
  // Weight & Dimensions (for shipping)
  weight      Decimal? @db.Decimal(10, 2) // in kg
  length      Decimal? @db.Decimal(10, 2) // in cm
  width       Decimal? @db.Decimal(10, 2) // in cm
  height      Decimal? @db.Decimal(10, 2) // in cm
  
  // SEO
  metaTitle       String?
  metaDescription String?
  metaKeywords    String?
  
  // Product Characteristics
  isFeatured      Boolean @default(false)
  isEcoFriendly   Boolean @default(false)
  isHandmade      Boolean @default(false)
  isLocal         Boolean @default(false)
  isSustainable   Boolean @default(false)
  isOrganic       Boolean @default(false)
  isHalal         Boolean @default(false)     // For Islamic products
  isSunnahBased   Boolean @default(false)     // For Sunnah Health
  
  // Timestamps
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  publishedAt DateTime?

  // Category relationship
  categoryId String
  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  // Relations
  images              ProductImage[]
  variants            ProductVariant[]
  inventory           Inventory?
  healthWellness      HealthWellness?      // For Sunnah Health, Personal Care
  eventSupply         EventSupply?         // For Event/Party items
  repairKit           RepairKit?           // For Repair Kits
  islamicDecor        IslamicDecor?        // For Islamic Art
  attributes          ProductAttribute[]
  
  @@index([productType])
  @@index([status])
  @@index([slug])
  @@index([sku])
  @@index([categoryId])
}

// ============================================
// PRODUCT VARIANTS (sizes, colors, etc.)

model ProductVariant {
  id        String  @id @default(cuid())
  productId String
  sku       String  @unique
  name      String   // e.g., "Black - Large", "500ml"
  price     Decimal @db.Decimal(10, 2)
  
  // Variant attributes
  attributes Json?  // { "color": "Black", "size": "L", "volume": "500ml" }
  
  // Weight (if different from base)
  weight    Decimal? @db.Decimal(10, 2)
  image     String?
  
  sortOrder Int     @default(0)
  isActive  Boolean @default(true)
  
  product   Product   @relation(fields: [productId], references: [id], onDelete: Cascade)
  inventory Inventory?
  
  @@index([productId])
}

// ============================================
// INVENTORY MANAGEMENT

model Inventory {
  id              String   @id @default(cuid())
  productId       String?  @unique
  variantId       String?  @unique
  quantity        Int      @default(0)
  reservedQuantity Int     @default(0)
  lowStockAlert   Int      @default(10)
  
  // Tracking
  warehouseLocation String?
  reorderPoint      Int?
  reorderQuantity   Int?
  
  updatedAt       DateTime @updatedAt
  
  product         Product?        @relation(fields: [productId], references: [id], onDelete: Cascade)
  variant         ProductVariant? @relation(fields: [variantId], references: [id], onDelete: Cascade)
  
  @@index([quantity])
}

// ============================================
// HEALTH & WELLNESS (Sunnah Health, Personal Care)

model HealthWellness {
  id          String   @id @default(cuid())
  productId   String   @unique
  
  // Product type
  category    String?  // "Supplement", "Oil", "Cream", "Soap", "Shampoo", "Honey"
  
  // Ingredients
  ingredients Json?    // ["Black Seed Oil", "Honey", "Olive Oil"]
  activeIngredients String? @db.Text
  
  // Certifications
  isOrganic       Boolean @default(false)
  isVegan         Boolean @default(false)
  isCrueltyFree   Boolean @default(false)
  isHalal         Boolean @default(false)
  certifications  Json?   // ["USDA Organic", "Halal Certified"]
  
  // Sunnah-based specifics
  isSunnahBased   Boolean @default(false)
  sunnahReference String? @db.Text  // Hadith or Islamic reference
  
  // Usage
  usage           String? @db.Text
  dosage          String?
  warnings        String? @db.Text
  
  // For personal care
  skinType        String? // "All skin types", "Sensitive", "Oily"
  scent           String? // "Unscented", "Lavender", "Rose"
  
  // Volume/quantity
  volume          String? // "100ml", "500g", "60 capsules"
  
  // Expiry
  shelfLife       String? // "2 years", "12 months"
  expiryDate      DateTime?
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  product         Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
}

// ============================================
// EVENT SUPPLIES (Party Decorations, Event items)

model EventSupply {
  id              String   @id @default(cuid())
  productId       String   @unique
  eventType       String?  
  ageGroup        String?  // "Kids", "Teens", "Adults", "All ages"
  occasion        String?  // "Eid", "Ramadan", "Wedding", "Baby shower"
  
  // Rental option
  isRentable      Boolean  @default(false)
  rentalPricePerDay Decimal? @db.Decimal(10, 2)
  depositRequired Decimal? @db.Decimal(10, 2)
  rentalDuration  Int?     // default days
  
  // Quantity
  minimumOrder    Int?
  maximumOrder    Int?
  packSize        Int?     // items per pack
  
  isReusable      Boolean  @default(false)
  isDisposable    Boolean  @default(false)
  isCustomizable  Boolean  @default(false)
  isEcoFriendly   Boolean  @default(false)
  
  // Setup
  setupTime       Int?     // minutes
  requiresAssembly Boolean @default(false)
  assemblyInstructions String? @db.Text
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  product         Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
}

// ============================================
// REPAIR KIT (Repair & Restoration Kit Store)

model RepairKit {
  id              String   @id @default(cuid())
  productId       String   @unique
  
  // What it repairs
  repairType      String?  // "Electronics", "Furniture", "Clothing", "Shoes"
  itemsIncluded   Json?    // ["Screwdriver set", "Glue", "Sandpaper"]
  toolsIncluded   Int?     // number of tools
  
  // Difficulty & usage
  skillLevel      String?  // "Beginner", "Intermediate", "Advanced"
  estimatedTime   String?  // "30 minutes", "2 hours"
  
  // Instructions
  instructionsPdf String?
  instructionsText String? @db.Text
  
  // Compatibility
  compatibleWith  String?  // "iPhone 12/13", "Wooden furniture", etc.
  
  // Contents
  isRefillable    Boolean  @default(false)
  consumables     Json?    // ["Adhesive", "Paint"] - items that run out
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  product         Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
}

// ============================================
// ISLAMIC DECOR (Islamic Art & Decor)

model IslamicDecor {
  id              String   @id @default(cuid())
  productId       String   @unique
  artType         String?  // "Calligraphy", "Geometric", "Ayah", "Hadith", "Name of Allah"
  artStyle        String?  // "Traditional", "Modern", "Minimalist"
  
  // Islamic content
  arabicText      String?  @db.Text  // The actual Arabic text
  transliteration String?  @db.Text
  translation     String?  @db.Text
  reference       String?  // "Quran 2:255", "Hadith Bukhari"
  
  // Decor specifics
  decorType       String?  // "Wall Art", "Table decor", "Hanging", "Frame"
  frameIncluded   Boolean  @default(false)
  frameType       String?  // "Wood", "Metal", "No frame"
  frameMaterial   String?
  
  // Material
  material        String?  // "Canvas", "Wood", "Metal", "Acrylic", "Paper"
  finish          String?  // "Matte", "Glossy", "Textured"
  
  // Dimensions
  dimensions      String?  // "12x16 inches", "A4 size"
  orientation     String?  // "Portrait", "Landscape", "Square"
  
  isHandcrafted   Boolean  @default(false)
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  product         Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
}

// ============================================
// PRODUCT IMAGES

model ProductImage {
  id        String   @id @default(cuid())
  productId String
  
  url       String
  altText   String?
  isPrimary Boolean  @default(false)
  sortOrder Int      @default(0)
  
  createdAt DateTime @default(now())
  
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  
  @@index([productId])
  @@index([isPrimary])
}

// ============================================
// PRODUCT ATTRIBUTES (Flexible key-value)

model ProductAttribute {
  id        String  @id @default(cuid())
  productId String
  key       String  // "material", "origin", "certification", "color", "brand"
  value     String  // "organic cotton", "USA", "Fair Trade", "Blue"
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  @@unique([productId, key])
  @@index([productId])
  @@index([key])
}